<!-- ENTRY_ID: https://velog.io/@limseohyeon/10%EB%B6%84-%ED%85%8C%EC%BD%94%ED%86%A1-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%A0%95%EA%B7%9C%ED%99%94 -->
<!-- SOURCE_TITLE: 데이터베이스 정규화 - 10분 테코톡 -->

<p><img alt="" src="https://velog.velcdn.com/images/limseohyeon/post/8b1d81be-a525-4eb5-bca8-68db4781156d/image.png" />
🔗<a href="https://youtu.be/-R6YnlFYrIY?si=y7D1thYB6iw899mp">10분 테코톡 - 데이터 베이스 정규화</a></p>
<h1 id="1-데이터베이스-정규화란">1. 데이터베이스 정규화란?</h1>
<hr />
<p>비정규화된 테이블은 중복성/일관성 없는 종속성 문제가 발생한다. </p>
<p>정규화란 테이블 간에 중복과 이상 현상을 최소화하기 위해 테이블을 분해하고 구조화하는 절차이다.</p>
<h3 id="중복성-문제">중복성 문제</h3>
<table>
<thead>
<tr>
<th>학번</th>
<th>이름</th>
<th>과목코드</th>
<th>과목명</th>
</tr>
</thead>
<tbody><tr>
<td>1001</td>
<td>철수</td>
<td>C101</td>
<td>DB</td>
</tr>
<tr>
<td>1001</td>
<td>철수</td>
<td>C102</td>
<td>운영체제</td>
</tr>
<tr>
<td>1002</td>
<td>영희</td>
<td>C101</td>
<td>DB</td>
</tr>
<tr>
<td>- 저장 공간 낭비</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>- 데이터 무결성 위협</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h3 id="일관성-없는-종속성-문제">일관성 없는 종속성 문제</h3>
<table>
<thead>
<tr>
<th>학번</th>
<th>학생이름</th>
<th>교수ID</th>
<th>교수이름</th>
</tr>
</thead>
<tbody><tr>
<td>1001</td>
<td>철수</td>
<td>P01</td>
<td>김교수</td>
</tr>
<tr>
<td>1002</td>
<td>영희</td>
<td>P01</td>
<td>김교수</td>
</tr>
<tr>
<td>1003</td>
<td>민수</td>
<td>P02</td>
<td>박교수</td>
</tr>
<tr>
<td>- 데이터가 찾기 어려움</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>위 문제를 제거함으로서 유지보수성, 데이터 관리 안정성을 향상 시킬 수 있다.</p>
<h1 id="2-제1-정규화">2. 제1 정규화</h1>
<hr />
<p>모든 필드가 원자성을 갖는 정규화</p>
<p><strong>정규화 적용 전</strong></p>
<table>
<thead>
<tr>
<th>고객ID</th>
<th>이름</th>
<th>전화번호</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>철수</td>
<td>010-1111-2222, 010-3333-4444</td>
</tr>
<tr>
<td>2</td>
<td>영희</td>
<td>010-5555-6666</td>
</tr>
</tbody></table>
<p><strong>정규화 적용 후</strong></p>
<table>
<thead>
<tr>
<th>고객ID</th>
<th>이름</th>
<th>전화번호</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>철수</td>
<td>010-1111-2222</td>
</tr>
<tr>
<td>1</td>
<td>철수</td>
<td>010-3333-4444</td>
</tr>
<tr>
<td>2</td>
<td>영희</td>
<td>010-5555-6666</td>
</tr>
</tbody></table>
<h1 id="3-제2-정규화">3. 제2 정규화</h1>
<hr />
<p>부분 함수 종속성을 제거하는 정규화</p>
<p><strong>정규화 적용 전</strong></p>
<p>[학생-수강 테이블]</p>
<table>
<thead>
<tr>
<th>학번</th>
<th>과목코드</th>
<th>학생이름</th>
<th>과목이름</th>
</tr>
</thead>
<tbody><tr>
<td>1001</td>
<td>C101</td>
<td>철수</td>
<td>DB</td>
</tr>
<tr>
<td>1001</td>
<td>C102</td>
<td>철수</td>
<td>운영체제</td>
</tr>
<tr>
<td>1002</td>
<td>C101</td>
<td>영희</td>
<td>DB</td>
</tr>
<tr>
<td>- 기본키 = (학번, 과목코드)로 복합키</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>- 학생 이름은 학번에만 종속</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>- 과목이름은 과목코드에만 종속</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>즉 , 기본키 일부에만 종속되는 값이 존재하기 때문에 제2 정규화를 위반한 것이다.</p>
<p><strong>정규화 적용 후</strong></p>
<p>[학생 테이블]</p>
<table>
<thead>
<tr>
<th>학번</th>
<th>학생이름</th>
</tr>
</thead>
<tbody><tr>
<td>1001</td>
<td>철수</td>
</tr>
<tr>
<td>1002</td>
<td>영희</td>
</tr>
</tbody></table>
<p>[과목 테이블]</p>
<table>
<thead>
<tr>
<th>과목코드</th>
<th>과목이름</th>
</tr>
</thead>
<tbody><tr>
<td>C101</td>
<td>DB</td>
</tr>
<tr>
<td>C102</td>
<td>운영체제</td>
</tr>
</tbody></table>
<p>[수강 테이블]</p>
<table>
<thead>
<tr>
<th>학번</th>
<th>과목코드</th>
</tr>
</thead>
<tbody><tr>
<td>1001</td>
<td>C101</td>
</tr>
<tr>
<td>1001</td>
<td>C102</td>
</tr>
<tr>
<td>1002</td>
<td>C101</td>
</tr>
</tbody></table>
<h1 id="4-제3-정규화">4. 제3 정규화</h1>
<hr />
<p>이행 종속성 제거하하는 정규화</p>
<p><strong>정규화 적용 전</strong></p>
<table>
<thead>
<tr>
<th>직원ID</th>
<th>직원이름</th>
<th>부서ID</th>
<th>부서이름</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>철수</td>
<td>D01</td>
<td>인사팀</td>
</tr>
<tr>
<td>2</td>
<td>영희</td>
<td>D02</td>
<td>개발팀</td>
</tr>
<tr>
<td>3</td>
<td>민수</td>
<td>D02</td>
<td>개발팀</td>
</tr>
<tr>
<td>- 키본키: 직원ID</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>- 부서이름은 직원ID에 직접 종속되지 않고, 부서ID를 통해서만 결정된다.</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<p>즉, 기본키에 종속되지 않은 값이 존재하기 때문에 제3 정규화를 위반한 것이다.</p>
<p><strong>정규화 적용 후</strong></p>
<p>[직원 테이블]</p>
<table>
<thead>
<tr>
<th>직원ID</th>
<th>직원이름</th>
<th>부서ID</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>철수</td>
<td>D01</td>
</tr>
<tr>
<td>2</td>
<td>영희</td>
<td>D02</td>
</tr>
<tr>
<td>3</td>
<td>민수</td>
<td>D02</td>
</tr>
</tbody></table>
<p>[부서 테이블]</p>
<table>
<thead>
<tr>
<th>부서ID</th>
<th>부서이름</th>
</tr>
</thead>
<tbody><tr>
<td>D01</td>
<td>인사팀</td>
</tr>
<tr>
<td>D02</td>
<td>개발팀</td>
</tr>
</tbody></table>
<h1 id="5-주의점">5. 주의점</h1>
<hr />
<p>정규화는 단순히 데이터에 중복이 발생할 때가 아닌 하나의 테이블에 <strong>불필요하거나 비정상적인 종속 관계</strong>가 존재할 때 실행한다.</p>
<h1 id="6-jpa-환경에서는-어떻게-구현할까">6. JPA 환경에서는 어떻게 구현할까?</h1>
<hr />
<pre><code class="language-java">@Entity
@Table(name = &quot;orders_denormalized&quot;)
public class OrderDenormalized {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private Integer orderQuantity;

    private String customerName;

    private String customerAddress;

    private String productName;

    private Integer productPrice;

    private Integer productStockQuantity;

    private LocalDateTime createdAt = LocalDateTime.now();

}
</code></pre>
<table>
<thead>
<tr>
<th>주문id</th>
<th>주문수량</th>
<th>주문자 이름</th>
<th>주문자 주소</th>
<th>상품 이름</th>
<th>상품 가격</th>
<th>상품 수량</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>2</td>
<td>홍길동</td>
<td>서울시 마포구</td>
<td>무선마우스</td>
<td>25,000</td>
<td>100</td>
</tr>
<tr>
<td>2</td>
<td>1</td>
<td>홍길동</td>
<td>서울시 마포구</td>
<td>키보드</td>
<td>45,000</td>
<td>50</td>
</tr>
<tr>
<td>3</td>
<td>3</td>
<td>김영희</td>
<td>부산시 해운대구</td>
<td>무선마우스</td>
<td>25,000</td>
<td>100</td>
</tr>
</tbody></table>
<p>위는 Order에 불필요한 주문자와 상품에 대한 정보가 들어있는 제3 정규화를 위반한 예제이다. </p>
<p>이를 해결하기 위한 정규화를 진행하면 아래와 같다.</p>
<ol>
<li>각 항목을 별도의 Entity로 분리<ol>
<li>Order : 주문id, 주문 수량</li>
<li>Customer : 주문자 이름, 주문자 주소</li>
<li>Product : 상품 이름, 상품 가격, 상품 수량</li>
</ol>
</li>
<li>Order - Customer, Product 간 연관관계 설정</li>
</ol>
<p><strong>결과</strong></p>
<p><strong>Customer</strong></p>
<pre><code class="language-java">@Entity
public class Customer {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false)
    private String name;

    private String address;
}</code></pre>
<p><strong>Product</strong></p>
<pre><code class="language-java">@Entity
public class Product {
    @Id @GeneratedValue(strategy = GenerationType.IDENTIT
    private Long id;

    @Column(nullable = false)
    private String name;

    private Integer price;

    private Integer stockQuantity;
}
</code></pre>
<p><strong>OrderEntity</strong></p>
<pre><code class="language-java">@Entity
public class OrderEntity {
    @Id @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    private Integer orderQuantity;

    @ManyToOne(fetch = FetchType.LAZY, optional = false)
    private Customer customer;

    @ManyToOne(fetch = FetchType.LAZY, optional = false)
    private Product pro
}
</code></pre>